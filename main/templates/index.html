{% extends "base.html" %}
{% import 'bootstrap/wtf.html' as wtf %}

{% block scripts %}
{{ super() }}
<script>
    var e = document.getElementById("created_by_name");
    e.addEventListener("change", function() {
        document.getElementById("created_by_id").selectedIndex = e.selectedIndex;
    });

    var f = document.getElementById("closed_by_name");
    f.addEventListener("change", function() {
        document.getElementById("closed_by_id").selectedIndex = f.selectedIndex;
    });

    var g = document.getElementById("assign_to_name");
    g.addEventListener("change", function() {
        document.getElementById("assign_to_id").selectedIndex = g.selectedIndex;
    });

    <!-- Ensure that the disabled field is still submitted -->
    $("#req_form").submit(function(event) {
        $("#created_by_id").prop("disabled", false);
        $("#closed_by_id").prop("disabled", false);
        $("#assign_to_id").prop("disabled", false);
    });
</script>
{% endblock %}

{% block app_content %}
    <h1>Welcome, {{ current_user.staff_name }}!</h1>
    <p>You should be able to fill up the form here!</p>

    <p>Name of Staff: {{ current_user.staff_name }}</p>
    <p>Staff ID: {{ current_user.staff_id }}</p>
    <p>Staff Designation: {{ current_user.staff_designation }}</p>
    <p>Date Appealed: {{ moment(current_time).format('LLL') }}</p>

    <h2>Details required for the application</h2>
    <form id="req_form" action="" method="post" novalidate>
        {{ form.hidden_tag() }}
        {{ wtf.form_errors(form, hiddens="only") }}

        <!-- All staff ID is automatically generated from staff name, hence is disabled -->
        <h3>Opportunity created by</h3>
        {{ wtf.form_field(form.created_by_name) }}
        {{ wtf.form_field(form.created_by_id, disabled=true) }}
        {{ wtf.form_field(form.create_date) }}

        <h3>Opportunity closed by</h3>
        {{ wtf.form_field(form.closed_by_name) }}
        {{ wtf.form_field(form.closed_by_id, disabled=true) }}
        {{ wtf.form_field(form.close_date) }}

        <h3>Opportunity assigned to</h3>
        {{ wtf.form_field(form.assign_to_name) }}
        {{ wtf.form_field(form.assign_to_id, disabled=true) }}

        {{ wtf.form_field(form.pdt_name) }}
        {{ wtf.form_field(form.submit) }}
    </form>

{% endblock %}
